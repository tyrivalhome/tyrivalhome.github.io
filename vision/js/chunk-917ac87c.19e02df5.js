(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-917ac87c"],{2226:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"screen-overview"},[i("div",{staticClass:"logo"}),i("div",{staticClass:"title"},[t._v("VISION")]),i("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":t.menuIndex,mode:"horizontal","background-color":"rgba(0,0,0,0)","text-color":"#fff","active-text-color":"#00BAFF"},on:{select:t.selectMenu}},[i("el-menu-item",{attrs:{index:"0"}},[i("i",{staticClass:"icon iconfont icon-layer"},[t._v("我的可视化")])]),i("el-menu-item",{attrs:{index:"1"}},[i("i",{staticClass:"icon iconfont icon-cube"},[t._v("我的系统")])]),i("el-menu-item",{attrs:{index:"2"}},[i("i",{staticClass:"icon iconfont icon-datasource"},[t._v("我的数据源")])])],1),i("div",{staticClass:"system"},[i("i",{staticClass:"icon iconfont icon-user"},[i("span",[t._v(t._s(t.userInfo.name))])]),i("i",{staticClass:"icon iconfont icon-logout",on:{click:t.logout}})]),i("div",{directives:[{name:"show",rawName:"v-show",value:"0"===t.menuIndex,expression:"menuIndex==='0'"}],staticClass:"container container-result"},[i("div",{staticClass:"card add",on:{click:t.addScreen}},[i("div",{staticClass:"content"},[i("i",{staticClass:"icon iconfont icon-plus"}),i("div",[t._v("新建可视化")]),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"导入配置",placement:"bottom"}},[i("i",{staticClass:"el-icon-upload",on:{click:t.showImporter}})])],1)]),t.screen.list&&t.screen.list.length?[t._l(t.screen.list,(function(e,a){return[i("div",{key:a,staticClass:"card"},[i("div",{staticClass:"img-cover"},[e.cover?i("img",{attrs:{src:e.cover}}):t._e()]),i("div",{staticClass:"title-bar"},[i("el-row",[i("el-col",{staticClass:"name",attrs:{span:16}},[t._v(t._s(e.name||"未命名"))]),i("el-col",{staticClass:"state",attrs:{span:8}},[0===e.state?i("el-tag",{attrs:{size:"mini",type:"info"}},[t._v("未发布")]):i("el-tag",{attrs:{size:"mini",type:"success"}},[t._v("已发布")])],1)],1)],1),i("div",{staticClass:"toolbar"},[i("div",{staticClass:"delete"},[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[i("i",{staticClass:"icon iconfont icon-delete",on:{click:function(e){return t.deleteScreen(a)}}})])],1),i("div",{staticClass:"edit"},[i("el-button",{attrs:{type:"primary",size:"mini",round:""},on:{click:function(e){return t.editScreen(a)}}},[t._v(" 编 辑")])],1),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"导出",placement:"bottom"}},[i("i",{staticClass:"icon iconfont icon-download",on:{click:function(e){return t.exportScreen(a)}}})]),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"预览",placement:"bottom"}},[i("i",{staticClass:"icon iconfont icon-view",on:{click:function(e){return t.previewScreen(a)}}})]),"OFF"===e.state?i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"发布",placement:"bottom"}},[i("i",{staticClass:"icon iconfont icon-plane",on:{click:function(e){return t.publishScreen(a,"ON")}}})]):i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"撤回",placement:"bottom"}},[i("i",{staticClass:"icon iconfont icon-undo",on:{click:function(e){return t.publishScreen(a,"OFF")}}})])],1)])]}))]:t._e()],2),i("div",{directives:[{name:"show",rawName:"v-show",value:"1"===t.menuIndex,expression:"menuIndex==='1'"}],staticClass:"container container-result"},[i("div",{staticClass:"card add",on:{click:t.addIntegration}},[t._m(0)]),t.integration.list&&t.integration.list.length?[t._l(t.integration.list,(function(e,a){return[i("div",{key:a,staticClass:"card"},[e.cover?[i("div",{staticClass:"img-cover"})]:[i("img",{staticClass:"img-cover",attrs:{src:e.cover}})],i("div",{staticClass:"title-bar"},[i("el-row",[i("el-col",{staticClass:"name",attrs:{span:16}},[t._v(t._s(e.name||"未命名"))]),i("el-col",{staticClass:"state",attrs:{span:8}},[0===e.state?i("el-tag",{attrs:{size:"mini",type:"info"}},[t._v("未发布")]):i("el-tag",{attrs:{size:"mini",type:"success"}},[t._v("已发布")])],1)],1)],1),i("div",{staticClass:"toolbar"},[i("div",{staticClass:"delete"},[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[i("i",{staticClass:"icon iconfont icon-delete",on:{click:function(e){return t.deleteIntegration(a)}}})])],1),i("div",{staticClass:"edit"},[i("el-button",{attrs:{type:"primary",size:"mini",round:""},on:{click:function(e){return t.editIntegration(a)}}},[t._v(" 编 辑")])],1),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"导出",placement:"bottom"}},[i("i",{staticClass:"icon iconfont icon-download",on:{click:function(e){return t.exportIntegration(a)}}})]),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"预览",placement:"bottom"}},[i("i",{staticClass:"icon iconfont icon-view",on:{click:function(e){return t.previewIntegration(a)}}})]),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"发布",placement:"bottom"}},[i("i",{staticClass:"icon iconfont icon-plane",on:{click:function(e){return t.publishIntegration(a)}}})])],1)],2)]}))]:t._e()],2),i("div",{directives:[{name:"show",rawName:"v-show",value:"2"===t.menuIndex,expression:"menuIndex==='2'"}],staticClass:"container container-result"},[i("div",{staticClass:"ds-toolbar"},[i("div",{staticClass:"ds-add",on:{click:t.addDataSource}},[t._m(1)])]),i("div",{staticClass:"ds-list"},[t.dataSource.list&&t.dataSource.list.length?[t._l(t.dataSource.list,(function(e,a){return[i("el-col",{key:a,attrs:{span:12}},[i("div",{staticClass:"ds-block"},[i("div",{staticClass:"ds-tile"},[i("div",{staticClass:"ds-icon"},[i("i",{staticClass:"icon iconfont",class:e.type?"icon-"+e.type.toLowerCase():"icon-datasource-o"})]),i("div",{staticClass:"ds-name"},[t._v(t._s(e.name))]),i("div",{staticClass:"ds-time"},[t._v(t._s(e.createTime.substring(0,10)))])]),i("div",{staticClass:"ds-opts"},[i("div",{staticClass:"ds-opts-btn"},[t.isFileSource(e)?t._e():i("i",{staticClass:"icon iconfont icon-edit",on:{click:function(i){return t.editDataSource(e)}}}),i("i",{staticClass:"icon iconfont icon-delete",on:{click:function(i){return t.deleteDataSource(e)}}})])])])])]}))]:t._e()],2)]),i("Importer",{attrs:{config:t.importer}}),t.edit.visible?i("DataSourceEdit",{attrs:{config:t.edit}}):t._e()],1)},n=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"content"},[i("i",{staticClass:"icon iconfont icon-plus"}),i("div",[t._v("新建系统")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"ds-add-text"},[i("i",{staticClass:"icon iconfont icon-plus"}),t._v(" 新建数据源")])}],o=(i("ffc9"),i("32a0")),s=i("5225"),r=i("a3be"),c=i("7638"),l=i("2ef0"),u=i.n(l),d={name:"Overview",data:function(){return{userInfo:{name:""},menuIndex:"0",screen:{index:null,list:null},integration:{index:null,list:null},dataSource:{list:null},importer:{visible:!1},edit:{visible:!1,dataSource:{}}}},mounted:function(){this.initUserInfo(),this.listScreen(),this.listIntegration(),this.listDataSource()},methods:{initUserInfo:function(){var t=this;this.ajax({url:r["a"].USER.CURRENT,method:c["a"].AJAX.GET}).then((function(e){e&&e.success?t.userInfo=e.data:t.userInfo.name="游客"}))},selectMenu:function(t){this.menuIndex=t},listScreen:function(){var t=this;this.ajax({url:r["a"].SCREEN.LIST,method:c["a"].AJAX.POST,data:{}}).then((function(e){t.screen.list=e.data}))},listIntegration:function(){var t=this;this.ajax({url:r["a"].INTEGRATION.LIST,method:c["a"].AJAX.POST,data:{}}).then((function(e){t.integration.list=e.data}))},listDataSource:function(){var t=this;this.ajax({url:r["a"].DATA_SOURCE.LIST_BY_USER,method:c["a"].AJAX.POST}).then((function(e){t.dataSource.list=e.data}))},addScreen:function(){this.$router.push("./design")},editScreen:function(t){this.$router.push("./design?id="+this.screen.list[t].id)},deleteScreen:function(t){var e=this;this.$confirm("可视化成果删除后无法恢复, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.ajax({url:r["a"].SCREEN.DELETE,params:{id:e.screen.list[t].id}}).then((function(i){i.success?(e.screen.list.splice(t,1),e.$message(c["a"].MESSAGE.DELETE_SUCCESS)):e.$message({message:i["message"],type:"error"})}))})).catch((function(){}))},exportScreen:function(t){var e=this.formatConfigParam(this.screen.list[t]);e.id=null;var i=document.createElement("a"),a=new Blob([JSON.stringify(e,null,4)]);i.download="config-"+(new Date).getTime(),i.href=URL.createObjectURL(a),i.click(),URL.revokeObjectURL(a)},previewScreen:function(t){var e=this.formatConfigParam(this.screen.list[t]),i=e.id,a=this.$router.resolve({path:"./presentation",query:{id:i}});window.open(a.href,"_blank")},publishScreen:function(t,e){var i=this,a=this.formatConfigParam(this.screen.list[t]);a.state=e,this.ajax({url:r["a"].SCREEN.PUBLISH,method:c["a"].AJAX.POST,data:a}).then((function(t){i.listScreen(),i.$message({type:"ON"==e?"success":"warning",message:"ON"==e?"发布成功":"撤回成功"})}))},formatConfigParam:function(t){var e=u.a.cloneDeep(t);for(var i in e){var a=e[i];u.a.isObject(a)&&(e[i]=JSON.stringify(a))}return e},addIntegration:function(){this.$router.push("./integration")},editIntegration:function(t){this.$router.push("./integration?id="+this.integration.list[t].id)},deleteIntegration:function(t){var e=this;this.$confirm("可视化成果删除后无法恢复, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.ajax({url:r["a"].INTEGRATION.DELETE,params:{id:e.integration.list[t].id}}).then((function(i){i.success?(e.integration.list.splice(t,1),e.$message(c["a"].MESSAGE.DELETE_SUCCESS)):e.$message({message:i["message"],type:"error"})}))})).catch((function(){}))},exportIntegration:function(t){var e=this.formatConfigParam(this.integration.list[t]);e.id=null;var i=document.createElement("a"),a=new Blob([JSON.stringify(e,null,4)]);i.download="integration-"+(new Date).getTime(),i.href=URL.createObjectURL(a),i.click(),URL.revokeObjectURL(a)},previewIntegration:function(t){var e=this.formatConfigParam(this.integration.list[t]),i=e.id,a=this.$router.resolve({path:"./integration_presentation",query:{id:i}});window.open(a.href,"_blank")},publishIntegration:function(t){var e=this,i=this.formatConfigParam(this.integration.list[t]);this.ajax({url:r["a"].INTEGRATION.PUBLISH,method:c["a"].AJAX.POST,data:i}).then((function(t){e.listIntegration(),e.$message(c["a"].MESSAGE.SAVE_SUCCESS)}))},addDataSource:function(){this.edit={visible:!0,dataSource:null}},editDataSource:function(t){var e=this;this.ajax({url:r["a"].DATA_SOURCE.GET,method:c["a"].AJAX.POST,data:{dsId:t.id,type:t.type}}).then((function(t){e.edit={visible:!0,dataSource:t.data}}))},deleteDataSource:function(t){var e=this;this.$confirm("数据源删除后无法恢复, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.ajax({url:r["a"].DATA_SOURCE.DELETE,method:c["a"].AJAX.POST,data:{dsId:t.id,type:t.type}}).then((function(i){e.$message(c["a"].MESSAGE.DELETE_SUCCESS);for(var a=0;a<e.dataSource.list.length;a++)e.dataSource.list[a].id===t.id&&e.dataSource.list.splice(a,1)}))})).catch((function(){}))},isFileSource:function(t){return"EXCEL"===t.type},showImporter:function(t){this.importer.visible=!0,t.stopPropagation()},logout:function(){var t=this;this.$confirm("是否注销",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$store.commit(c["a"].MUTATIONS.SET_TOKEN,null),t.$cookies.remove(c["a"].AJAX.TOKEN),t.$router.push("./login")})).catch((function(){}))}},watch:{"importer.visible":function(t){this.importer.visible||this.listDataSource()},"edit.visible":function(t){this.edit.visible||this.listDataSource()}},components:{Importer:s["default"],DataSourceEdit:o["default"]}},f=d,m=i("2877"),p=Object(m["a"])(f,a,n,!1,null,null,null);e["default"]=p.exports},"288b":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-form",{ref:"dbSourceForm",attrs:{model:t.config.dataSource,rules:t.rules,size:"mini","label-width":"80px"}},[i("el-form-item",{attrs:{label:"域名/IP",prop:"host"}},[i("el-input",{model:{value:t.config.dataSource.host,callback:function(e){t.$set(t.config.dataSource,"host",e)},expression:"config.dataSource.host"}})],1),i("el-form-item",{attrs:{label:"端口",prop:"port"}},[i("el-input",{model:{value:t.config.dataSource.port,callback:function(e){t.$set(t.config.dataSource,"port",e)},expression:"config.dataSource.port"}})],1),i("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[i("el-input",{model:{value:t.config.dataSource.userName,callback:function(e){t.$set(t.config.dataSource,"userName",e)},expression:"config.dataSource.userName"}})],1),i("el-form-item",{attrs:{label:"密码",prop:"password"}},[i("el-input",{model:{value:t.config.dataSource.password,callback:function(e){t.$set(t.config.dataSource,"password",e)},expression:"config.dataSource.password"}})],1),i("el-form-item",{attrs:{label:"数据库",prop:"db"}},[i("el-input",{model:{value:t.config.dataSource.db,callback:function(e){t.$set(t.config.dataSource,"db",e)},expression:"config.dataSource.db"}})],1)],1)},n=[],o=(i("7638"),i("a3be"),{name:"DatabaseForm",props:["config"],data:function(){return{rules:{host:[{required:!0,message:"必须填写"}],port:[{required:!0,message:"必须填写"}],userName:[{required:!0,message:"必须填写"}],password:[{required:!0,message:"必须填写"}],db:[{required:!0,message:"必须填写"}]},db:[]}},mounted:function(){this.config&&this.config.dataSource.id&&this.config.dataSource.id&&this.initDb()},methods:{}}),s=o,r=i("2877"),c=Object(r["a"])(s,a,n,!1,null,"03773d5a",null);e["default"]=c.exports},"32a0":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{width:"40%",title:t.config.dataSource.id?"编辑数据源":"新建数据源",visible:t.config.visible,"close-on-click-modal":!1},on:{"update:visible":function(e){return t.$set(t.config,"visible",e)}}},[i("el-form",{ref:"dataSourceForm",attrs:{model:t.config.dataSource,rules:t.rules,size:"mini","label-width":"80px"}},[i("el-form-item",{attrs:{label:"名称",prop:"name"}},[i("el-input",{model:{value:t.config.dataSource.name,callback:function(e){t.$set(t.config.dataSource,"name",e)},expression:"config.dataSource.name"}})],1),i("el-form-item",{attrs:{label:"类型"}},[i("el-select",{attrs:{placeholder:"请选择数据源类型","default-first-option":!0},model:{value:t.config.dataSource.type,callback:function(e){t.$set(t.config.dataSource,"type",e)},expression:"config.dataSource.type"}},t._l(t.dataSourceType,(function(t){return i("el-option",{key:t.type,attrs:{label:t.desc,value:t.type}})})),1)],1)],1),i(t.form.loader[t.form.mapper[t.config.dataSource.type]].default,{ref:"subDsForm",tag:"component",attrs:{config:t.config}}),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.save}},[t._v("确 定")]),i("el-button",{attrs:{size:"mini"},on:{click:function(e){t.config.visible=!1}}},[t._v("取 消")])],1)],1)},n=[],o=i("a3be"),s=i("7638"),r=i("2ef0"),c=i.n(r),l={name:"DataSourceEdit",props:["config"],data:function(){return{rules:{name:[{required:!0,message:"必须填写名称",trigger:"blur"}]},form:{mapper:{},url:{},loader:{}},dataSourceType:[{type:"EXCEL",desc:"XLS/CSV 文件",form:"FileForm",url:o["a"].DATA_SOURCE.SAVE_FILE},{type:"POSTGRESQL",desc:"PostgreSQL数据库",form:"DatabaseForm",url:o["a"].DATA_SOURCE.SAVE_DATABASE},{type:"MYSQL",desc:"MySQL数据库",form:"DatabaseForm",url:o["a"].DATA_SOURCE.SAVE_DATABASE},{type:"ORACLE",desc:"Oracle数据库",form:"DatabaseForm",url:o["a"].DATA_SOURCE.SAVE_DATABASE},{type:"SQLSERVER",desc:"SqlServer数据库",form:"DatabaseForm",url:o["a"].DATA_SOURCE.SAVE_DATABASE}]}},created:function(){this.loadForm(),this.config.dataSource||(this.config.dataSource=c.a.assignIn({},this.dataSourceType[0]))},methods:{save:function(){var t=this,e=this.$refs.dataSourceForm,i=this.$refs.subDsForm;e.validate((function(e,a){e&&i.$children[0].validate((function(e,i){if(e){var a=t.form.url[t.config.dataSource.type];t.ajax({url:a,method:s["a"].AJAX.POST,data:t.config.dataSource}).then((function(e){e.success&&(t.$message(s["a"].MESSAGE.SAVE_SUCCESS),t.config.visible=!1)}))}}))}))},loadForm:function(){for(var t=0;t<this.dataSourceType.length;t++){var e=this.dataSourceType[t],a=e.form;this.form.mapper[e.type]=a,this.form.url[e.type]=e.url,this.form.loader[a]||(this.form.loader[a]=i("5fac")("./"+a+".vue"))}}}},u=l,d=i("2877"),f=Object(d["a"])(u,a,n,!1,null,"54529620",null);e["default"]=f.exports},"4ef4":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-form-item",{attrs:{label:"url",required:""}},[i("el-input",{model:{value:t.config.dataSource.url,callback:function(e){t.$set(t.config.dataSource,"url",e)},expression:"config.dataSource.url"}})],1),i("el-form-item",{attrs:{label:"协议",required:""}},[i("el-select",{attrs:{placeholder:"请选择协议类型"},model:{value:t.config.dataSource.protocol,callback:function(e){t.$set(t.config.dataSource,"protocol",e)},expression:"config.dataSource.protocol"}},t._l(t.protocol,(function(t,e){return i("el-option",{key:t.name,attrs:{label:t.name,value:t.name}})})),1)],1)],1)},n=[],o={name:"ApiForm",props:["config"],data:function(){return{protocol:[{name:"http"},{name:"https"}]}}},s=o,r=i("2877"),c=Object(r["a"])(s,a,n,!1,null,"d93b1e12",null);e["default"]=c.exports},5225:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{width:"50%",title:"导入配置",visible:t.config.visible,"close-on-click-modal":!1},on:{"update:visible":function(e){return t.$set(t.config,"visible",e)}}},[i("el-row",[i("el-col",{attrs:{span:24}},[i("el-input",{attrs:{type:"textarea",rows:12,size:"mini",resize:"none"},model:{value:t.screen,callback:function(e){t.screen=e},expression:"screen"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.save}},[t._v("确 定")]),i("el-button",{attrs:{size:"mini"},on:{click:function(e){t.config.visible=!1}}},[t._v("取 消")])],1)],1)},n=[],o=i("a3be"),s=i("7638"),r={name:"Importer",props:["config"],data:function(){return{rules:{screen:[{required:!0,message:"配置不可为空",trigger:"blur"}]},screen:null}},methods:{save:function(){var t=this;try{JSON.parse(this.screen),this.ajax({url:o["a"].SCREEN.SAVE,method:s["a"].AJAX.POST,data:JSON.parse(this.screen)}).then((function(e){e.success&&(t.$message(s["a"].MESSAGE.SAVE_SUCCESS),t.config.visible=!1)}))}catch(e){this.$message({message:s["a"].MESSAGE.JSON_PARSE_ERROR,type:"error"})}}}},c=r,l=i("2877"),u=Object(l["a"])(c,a,n,!1,null,"3591f3a2",null);e["default"]=u.exports},"5fac":function(t,e,i){var a={"./ApiForm.vue":"4ef4","./DatabaseForm.vue":"288b","./FileForm.vue":"8992"};function n(t){var e=o(t);return i(e)}function o(t){if(!i.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}n.keys=function(){return Object.keys(a)},n.resolve=o,t.exports=n,n.id="5fac"},8992:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-form",{attrs:{model:t.config.dataSource,rules:t.rules,size:"mini","label-width":"80px"}},[i("el-form-item",{attrs:{label:"",prop:"attachment"}},[i("el-upload",{attrs:{drag:"",limit:1,headers:t.getToken(),action:t.getUploadUrl(),"before-upload":t.beforeUpload,"on-remove":t.remove,"on-success":t.onSuccess,"on-exceed":t.onExceed,"on-Error":t.onError}},[i("i",{staticClass:"el-icon-upload"}),i("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),i("em",[t._v("点击上传")])]),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传xls、xlsx、csv文件")])])],1)],1)},n=[],o=(i("7f7f"),i("a3be")),s=i("7638"),r={name:"FileForm",props:["config"],data:function(){var t=this,e=function(e,i,a){t.config.dataSource.attachmentId?a():a(new Error("请上传文件。"))};return{rules:{attachment:[{validator:e,trigger:"change"}]}}},methods:{beforeUpload:function(t){var e=t.name,i=e.substring(e.lastIndexOf(".")+1).toLowerCase();if("xls"!==i&&"xlsx"!==i&&"csv"!==i)return this.$message({message:"只支持xls、xlsx、csv文件",type:"error"}),!1},getUploadUrl:function(){return o["a"].ATTACHMENT.UPLOAD},getToken:function(){return{token:this.$store.state.token}},remove:function(t,e){var i=this;this.config.dataSource.id&&(this.ajax({url:o["a"].ATTACHMENT.DELETE,params:{id:this.config.dataSource.id}}).then((function(t){t.data.success&&i.$message(s["a"].MESSAGE.DELETE_SUCCESS)})),this.config.dataSource.id=null)},onSuccess:function(t){this.config.dataSource.attachmentId=t.data.id},onError:function(t){this.$message({message:t.data.message,type:"error"})},onExceed:function(t,e){this.$message({message:"最多只可上传1个文件，请删除当前文件后再上传",type:"error"})}}},c=r,l=i("2877"),u=Object(l["a"])(c,a,n,!1,null,"48386735",null);e["default"]=u.exports},ffc9:function(t,e,i){}}]);
//# sourceMappingURL=chunk-917ac87c.19e02df5.js.map