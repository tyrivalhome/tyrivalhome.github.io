(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7bcc3a70"],{2226:function(t,i,e){"use strict";e.r(i);var n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"screen-overview"},[e("div",{staticClass:"logo"}),e("div",{staticClass:"title"},[t._v("VISION")]),e("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":t.menuIndex,mode:"horizontal","background-color":"rgba(0,0,0,0)","text-color":"#fff","active-text-color":"#00BAFF"},on:{select:t.selectMenu}},[e("el-menu-item",{attrs:{index:"0"}},[e("i",{staticClass:"icon iconfont icon-layer"},[t._v("我的可视化")])]),e("el-menu-item",{attrs:{index:"1"}},[e("i",{staticClass:"icon iconfont icon-cube"},[t._v("我的系统")])]),e("el-menu-item",{attrs:{index:"2"}},[e("i",{staticClass:"icon iconfont icon-datasource"},[t._v("我的数据源")])])],1),e("div",{staticClass:"system"},[e("i",{staticClass:"icon iconfont icon-user"},[e("span",[t._v(t._s(t.userInfo.name))])]),e("i",{staticClass:"icon iconfont icon-logout",on:{click:t.logout}})]),e("div",{directives:[{name:"show",rawName:"v-show",value:"0"===t.menuIndex,expression:"menuIndex==='0'"}],staticClass:"container container-result"},[e("div",{staticClass:"card add",on:{click:t.addScreen}},[e("div",{staticClass:"content"},[e("i",{staticClass:"icon iconfont icon-plus"}),e("div",[t._v("新建可视化")]),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"导入配置",placement:"bottom"}},[e("i",{staticClass:"el-icon-upload",on:{click:t.showImporter}})])],1)]),t.screen.list&&t.screen.list.length?[t._l(t.screen.list,(function(i,n){return[e("div",{key:n,staticClass:"card"},[e("div",{staticClass:"img-cover"},[i.cover?e("img",{attrs:{src:i.cover}}):t._e()]),e("div",{staticClass:"title-bar"},[e("el-row",[e("el-col",{staticClass:"name",attrs:{span:16}},[t._v(t._s(i.name||"未命名"))]),e("el-col",{staticClass:"state",attrs:{span:8}},[0===i.state?e("el-tag",{attrs:{size:"mini",type:"info"}},[t._v("未发布")]):e("el-tag",{attrs:{size:"mini",type:"success"}},[t._v("已发布")])],1)],1)],1),e("div",{staticClass:"toolbar"},[e("div",{staticClass:"delete"},[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[e("i",{staticClass:"icon iconfont icon-delete",on:{click:function(i){return t.deleteScreen(n)}}})])],1),e("div",{staticClass:"edit"},[e("el-button",{attrs:{type:"primary",size:"mini",round:""},on:{click:function(i){return t.editScreen(n)}}},[t._v(" 编 辑")])],1),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"导出",placement:"bottom"}},[e("i",{staticClass:"icon iconfont icon-download",on:{click:function(i){return t.exportScreen(n)}}})]),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"预览",placement:"bottom"}},[e("i",{staticClass:"icon iconfont icon-view",on:{click:function(i){return t.previewScreen(n)}}})]),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"发布",placement:"bottom"}},[e("i",{staticClass:"icon iconfont icon-plane",on:{click:function(i){return t.publishScreen(n)}}})])],1)])]}))]:t._e()],2),e("div",{directives:[{name:"show",rawName:"v-show",value:"1"===t.menuIndex,expression:"menuIndex==='1'"}],staticClass:"container container-result"},[e("div",{staticClass:"card add",on:{click:t.addIntegration}},[t._m(0)]),t.integration.list&&t.integration.list.length?[t._l(t.integration.list,(function(i,n){return[e("div",{key:n,staticClass:"card"},[i.cover?[e("div",{staticClass:"img-cover"})]:[e("img",{staticClass:"img-cover",attrs:{src:i.cover}})],e("div",{staticClass:"title-bar"},[e("el-row",[e("el-col",{staticClass:"name",attrs:{span:16}},[t._v(t._s(i.name||"未命名"))]),e("el-col",{staticClass:"state",attrs:{span:8}},[0===i.state?e("el-tag",{attrs:{size:"mini",type:"info"}},[t._v("未发布")]):e("el-tag",{attrs:{size:"mini",type:"success"}},[t._v("已发布")])],1)],1)],1),e("div",{staticClass:"toolbar"},[e("div",{staticClass:"delete"},[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[e("i",{staticClass:"icon iconfont icon-delete",on:{click:function(i){return t.deleteIntegration(n)}}})])],1),e("div",{staticClass:"edit"},[e("el-button",{attrs:{type:"primary",size:"mini",round:""},on:{click:function(i){return t.editIntegration(n)}}},[t._v(" 编 辑")])],1),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"导出",placement:"bottom"}},[e("i",{staticClass:"icon iconfont icon-download",on:{click:function(i){return t.exportIntegration(n)}}})]),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"预览",placement:"bottom"}},[e("i",{staticClass:"icon iconfont icon-view",on:{click:function(i){return t.previewIntegration(n)}}})]),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"发布",placement:"bottom"}},[e("i",{staticClass:"icon iconfont icon-plane",on:{click:function(i){return t.publishIntegration(n)}}})])],1)],2)]}))]:t._e()],2),e("div",{directives:[{name:"show",rawName:"v-show",value:"2"===t.menuIndex,expression:"menuIndex==='2'"}],staticClass:"container container-result"},[e("div",{staticClass:"ds-toolbar"},[e("div",{staticClass:"ds-add",on:{click:t.addDataSource}},[t._m(1)])]),e("div",{staticClass:"ds-list"},[t.dataSource.list&&t.dataSource.list.length?[t._l(t.dataSource.list,(function(i,n){return[e("el-col",{key:n,attrs:{span:12}},[e("div",{staticClass:"ds-block"},[e("div",{staticClass:"ds-tile"},[e("div",{staticClass:"ds-icon"},[e("i",{staticClass:"icon iconfont",class:i.type?"icon-"+i.type.toLowerCase():"icon-datasource-o"})]),e("div",{staticClass:"ds-name"},[t._v(t._s(i.name))]),e("div",{staticClass:"ds-time"},[t._v(t._s(i.createTime.substring(0,10)))])]),e("div",{staticClass:"ds-opts"},[e("div",{staticClass:"ds-opts-btn"},[t.isFileSource(i)?t._e():e("i",{staticClass:"icon iconfont icon-edit",on:{click:function(e){return t.editDataSource(i)}}}),e("i",{staticClass:"icon iconfont icon-delete",on:{click:function(e){return t.deleteDataSource(i)}}})])])])])]}))]:t._e()],2)]),e("Importer",{attrs:{config:t.importer}}),t.edit.visible?e("DataSourceEdit",{attrs:{config:t.edit}}):t._e()],1)},a=[function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"content"},[e("i",{staticClass:"icon iconfont icon-plus"}),e("div",[t._v("新建系统")])])},function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"ds-add-text"},[e("i",{staticClass:"icon iconfont icon-plus"}),t._v(" 新建数据源")])}],s=(e("ffc9"),e("a3be")),o=e("7638"),c=e("2ef0"),r=e.n(c),l=function(){return e.e("chunk-daa249ce").then(e.bind(null,"32a0"))},u=function(){return e.e("chunk-2d0c7a96").then(e.bind(null,"5225"))},d={name:"Overview",data:function(){return{userInfo:{name:""},menuIndex:"0",screen:{index:null,list:null},integration:{index:null,list:null},dataSource:{list:null},importer:{visible:!1},edit:{visible:!1,dataSource:{}}}},mounted:function(){this.initUserInfo(),this.listScreen(),this.listIntegration(),this.listDataSource()},methods:{initUserInfo:function(){var t=this;this.ajax({url:s["a"].USER.CURRENT,method:o["a"].AJAX.GET}).then((function(i){i&&i.success?t.userInfo=i.data:t.userInfo.name="游客"}))},selectMenu:function(t){this.menuIndex=t},listScreen:function(){var t=this;this.ajax({url:s["a"].SCREEN.LIST,method:o["a"].AJAX.POST,data:{}}).then((function(i){t.screen.list=i.data}))},listIntegration:function(){var t=this;this.ajax({url:s["a"].INTEGRATION.LIST,method:o["a"].AJAX.POST,data:{}}).then((function(i){t.integration.list=i.data}))},listDataSource:function(){var t=this;this.ajax({url:s["a"].DATA_SOURCE.LIST_BY_USER,method:o["a"].AJAX.POST}).then((function(i){t.dataSource.list=i.data}))},addScreen:function(){this.$router.push("./design")},editScreen:function(t){this.$router.push("./design?id="+this.screen.list[t].id)},deleteScreen:function(t){var i=this;this.$confirm("可视化成果删除后无法恢复, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.ajax({url:s["a"].SCREEN.DELETE,params:{id:i.screen.list[t].id}}).then((function(e){e.success?(i.screen.list.splice(t,1),i.$message(o["a"].MESSAGE.DELETE_SUCCESS)):i.$message({message:e["message"],type:"error"})}))})).catch((function(){}))},exportScreen:function(t){var i=this.formatConfigParam(this.screen.list[t]);i.id=null;var e=document.createElement("a"),n=new Blob([JSON.stringify(i,null,4)]);e.download="config-"+(new Date).getTime(),e.href=URL.createObjectURL(n),e.click(),URL.revokeObjectURL(n)},previewScreen:function(t){var i=this.formatConfigParam(this.screen.list[t]),e=i.id,n=this.$router.resolve({path:"./presentation",query:{id:e}});window.open(n.href,"_blank")},publishScreen:function(t){var i=this,e=this.formatConfigParam(this.screen.list[t]);this.ajax({url:s["a"].SCREEN.PUBLISH,method:o["a"].AJAX.POST,data:e}).then((function(t){i.config.id||(i.config.id=t.data.id),i.$message(o["a"].MESSAGE.SAVE_SUCCESS)}))},formatConfigParam:function(t){var i=r.a.cloneDeep(t);for(var e in i){var n=i[e];r.a.isObject(n)&&(i[e]=JSON.stringify(n))}return i},addIntegration:function(){this.$router.push("./integration")},editIntegration:function(t){this.$router.push("./integration?id="+this.integration.list[t].id)},deleteIntegration:function(t){var i=this;this.$confirm("可视化成果删除后无法恢复, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.ajax({url:s["a"].INTEGRATION.DELETE,params:{id:i.integration.list[t].id}}).then((function(e){e.success?(i.integration.list.splice(t,1),i.$message(o["a"].MESSAGE.DELETE_SUCCESS)):i.$message({message:e["message"],type:"error"})}))})).catch((function(){}))},exportIntegration:function(t){var i=this.formatConfigParam(this.integration.list[t]);i.id=null;var e=document.createElement("a"),n=new Blob([JSON.stringify(i,null,4)]);e.download="integration-"+(new Date).getTime(),e.href=URL.createObjectURL(n),e.click(),URL.revokeObjectURL(n)},previewIntegration:function(t){var i=this.formatConfigParam(this.integration.list[t]),e=i.id,n=this.$router.resolve({path:"./integration_presentation",query:{id:e}});window.open(n.href,"_blank")},publishIntegration:function(t){var i=this,e=this.formatConfigParam(this.integration.list[t]);this.ajax({url:s["a"].INTEGRATION.PUBLISH,method:o["a"].AJAX.POST,data:e}).then((function(t){i.config.id||(i.config.id=t.data.id),i.$message(o["a"].MESSAGE.SAVE_SUCCESS)}))},addDataSource:function(){this.edit={visible:!0,dataSource:null}},editDataSource:function(t){var i=this;this.ajax({url:s["a"].DATA_SOURCE.GET,method:o["a"].AJAX.POST,data:{dsId:t.id,type:t.type}}).then((function(t){i.edit={visible:!0,dataSource:t.data}}))},deleteDataSource:function(t){var i=this;this.$confirm("数据源删除后无法恢复, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.ajax({url:s["a"].DATA_SOURCE.DELETE,method:o["a"].AJAX.POST,data:{dsId:t.id,type:t.type}}).then((function(e){i.$message(o["a"].MESSAGE.DELETE_SUCCESS);for(var n=0;n<i.dataSource.list.length;n++)i.dataSource.list[n].id===t.id&&i.dataSource.list.splice(n,1)}))})).catch((function(){}))},isFileSource:function(t){return"EXCEL"===t.type},showImporter:function(t){this.importer.visible=!0,t.stopPropagation()},logout:function(){var t=this;this.$confirm("是否注销",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$store.commit(o["a"].MUTATIONS.SET_TOKEN,null),t.$cookies.remove(o["a"].AJAX.TOKEN),t.$router.push("./login")})).catch((function(){}))}},watch:{"importer.visible":function(t){this.importer.visible||this.listDataSource()},"edit.visible":function(t){this.edit.visible||this.listDataSource()}},components:{Importer:u,DataSourceEdit:l}},f=d,m=e("2877"),v=Object(m["a"])(f,n,a,!1,null,null,null);i["default"]=v.exports},ffc9:function(t,i,e){}}]);
//# sourceMappingURL=chunk-7bcc3a70.48e5f12a.js.map