{"version":3,"sources":["webpack:///./src/components/screen/PictureStore.vue?d1b7","webpack:///src/components/screen/PictureStore.vue","webpack:///./src/components/screen/PictureStore.vue?4f49","webpack:///./src/components/screen/PictureStore.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","state","visible","on","$event","$set","staticClass","list","length","_l","item","i","key","class","currentId","id","choose","getPictureUrl","deletePicture","_e","slot","save","_v","staticRenderFns","component"],"mappings":"yHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,YAAY,CAACE,MAAM,CAAC,MAAQ,MAAM,MAAQ,KAAK,QAAUN,EAAIO,MAAMC,QAAQ,wBAAuB,GAAOC,GAAG,CAAC,iBAAiB,SAASC,GAAQ,OAAOV,EAAIW,KAAKX,EAAIO,MAAO,UAAWG,MAAW,CAACN,EAAG,MAAM,CAACQ,YAAY,qBAAqB,CAAEZ,EAAIa,MAAQb,EAAIa,KAAKC,OAAQ,CAACd,EAAIe,GAAIf,EAAQ,MAAE,SAASgB,EAAKC,GAAG,MAAO,CAACb,EAAG,MAAM,CAACc,IAAID,EAAEL,YAAY,eAAeO,MAAMnB,EAAIoB,YAAcJ,EAAKK,GAAK,SAAW,GAAGZ,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOV,EAAIsB,OAAOZ,EAAQM,MAAS,CAACZ,EAAG,MAAM,CAACE,MAAM,CAAC,IAAMN,EAAIuB,cAAcP,EAAKK,OAAOjB,EAAG,MAAM,CAACQ,YAAY,QAAQH,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOV,EAAIwB,cAAcd,EAAQM,MAAS,CAACZ,EAAG,IAAI,CAACQ,YAAY,sCAAqCZ,EAAIyB,MAAM,GAAGrB,EAAG,MAAM,CAACQ,YAAY,gBAAgBN,MAAM,CAAC,KAAO,UAAUoB,KAAK,UAAU,CAACtB,EAAG,YAAY,CAACE,MAAM,CAAC,KAAO,OAAO,KAAO,WAAWG,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOV,EAAI2B,KAAKjB,MAAW,CAACV,EAAI4B,GAAG,SAASxB,EAAG,YAAY,CAACE,MAAM,CAAC,KAAO,QAAQG,GAAG,CAAC,MAAQ,SAASC,GAAQV,EAAIO,MAAMC,SAAU,KAAS,CAACR,EAAI4B,GAAG,UAAU,MACnlCC,EAAkB,G,6CC+BtB,GACE,KAAF,eACE,MAAF,mBACE,KAHF,WAII,MAAJ,CACM,UAAN,KACM,KAAN,KAGE,QATF,WAUI,KAAJ,uBAEE,QAAF,CAII,OAJJ,SAIA,KACM,EAAN,kBACM,KAAN,gBAKI,KAXJ,SAWA,GAEM,GADA,EAAN,kBACA,eAAM,CAOA,IAAN,qCACM,EAAN,yCACM,KAAN,sBARQ,KAAR,UACU,QAAV,QACU,KAAV,WAWI,oBA3BJ,WA2BM,IAAN,OACM,KAAN,MACQ,IAAR,mCACQ,OAAR,kBACA,kBACQ,EAAR,2BAMI,cAtCJ,SAsCA,GACM,OAAN,qCAKI,cA5CJ,SA4CA,KAAM,IAAN,OACM,EAAN,kBACM,KAAN,kCACQ,kBAAR,KACQ,iBAAR,KACQ,KAAR,YACA,iBACQ,EAAR,MACU,IAAV,iDACU,OAAV,kBACA,kBACA,qBACY,EAAZ,gBAEU,EAAV,sBACU,EAAV,uBAEA,yBCzGqW,I,YCOjWC,EAAY,eACd,EACA/B,EACA8B,GACA,EACA,KACA,WACA,MAIa,aAAAC,E","file":"js/chunk-2d0c4bd4.87acdb0f.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-dialog',{attrs:{\"width\":\"80%\",\"title\":\"图库\",\"visible\":_vm.state.visible,\"close-on-click-modal\":false},on:{\"update:visible\":function($event){return _vm.$set(_vm.state, \"visible\", $event)}}},[_c('div',{staticClass:\"picture-container\"},[(_vm.list && _vm.list.length)?[_vm._l((_vm.list),function(item,i){return [_c('div',{key:i,staticClass:\"picture-card\",class:_vm.currentId === item.id ? 'active' : '',on:{\"click\":function($event){return _vm.choose($event, item)}}},[_c('img',{attrs:{\"src\":_vm.getPictureUrl(item.id)}}),_c('div',{staticClass:\"close\",on:{\"click\":function($event){return _vm.deletePicture($event, item)}}},[_c('i',{staticClass:\"icon iconfont icon-cross\"})])])]})]:_vm._e()],2),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"primary\"},on:{\"click\":function($event){return _vm.save($event)}}},[_vm._v(\"选 择\")]),_c('el-button',{attrs:{\"size\":\"mini\"},on:{\"click\":function($event){_vm.state.visible = false}}},[_vm._v(\"取 消\")])],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <el-dialog width=\"80%\"\r\n               title=\"图库\"\r\n               :visible.sync=\"state.visible\"\r\n               :close-on-click-modal=\"false\">\r\n        <div class=\"picture-container\">\r\n            <template v-if=\"list && list.length\">\r\n                <template v-for=\"(item, i) in list\">\r\n                    <div class=\"picture-card\"\r\n                         :class=\"currentId === item.id ? 'active' : ''\"\r\n                         :key=\"i\"\r\n                         @click=\"choose($event, item)\">\r\n                        <img :src=\"getPictureUrl(item.id)\">\r\n                        <div class=\"close\" @click=\"deletePicture($event, item)\">\r\n                            <i class=\"icon iconfont icon-cross\"></i>\r\n                        </div>\r\n                    </div>\r\n                </template>\r\n            </template>\r\n        </div>\r\n        <div slot=\"footer\" class=\"dialog-footer\">\r\n            <el-button size=\"mini\" type=\"primary\" @click=\"save($event)\">选 择</el-button>\r\n            <el-button size=\"mini\" @click=\"state.visible = false\">取 消</el-button>\r\n        </div>\r\n    </el-dialog>\r\n</template>\r\n\r\n<script>\r\n    import API from '../../config/api'\r\n    import CONST from \"../../config/const\";\r\n    import _ from 'lodash'\r\n\r\n    export default {\r\n        name: \"PictureStore\",\r\n        props: ['config', 'state'],\r\n        data() {\r\n            return {\r\n                currentId: null,\r\n                list: []\r\n            }\r\n        },\r\n        mounted() {\r\n            this.loadProprietaryList()\r\n        },\r\n        methods: {\r\n            /**\r\n             * 选择图片\r\n             */\r\n            choose(e, item) {\r\n                e.stopPropagation()\r\n                this.currentId = item.id\r\n            },\r\n            /**\r\n             * 保存\r\n             */\r\n            save(e) {\r\n                e.stopPropagation()\r\n                if (!this.currentId) {\r\n                    this.$message({\r\n                        message: \"未选择图片\",\r\n                        type: \"error\"\r\n                    })\r\n                    return\r\n                }\r\n                let url = this.getPictureUrl(this.currentId)\r\n                _.set(this.state.item, this.state.prop, url)\r\n                this.state.visible = false\r\n            },\r\n            /**\r\n             * 加载私有图库\r\n             */\r\n            loadProprietaryList() {\r\n                this.ajax({\r\n                    url: API.ATTACHMENT.LIST_PROPRIETARY,\r\n                    method: CONST.AJAX.GET,\r\n                }).then(response => {\r\n                    _.set(this, 'list', response.data)\r\n                })\r\n            },\r\n            /**\r\n             * 获取图片地址\r\n             */\r\n            getPictureUrl(id) {\r\n                return API.ATTACHMENT.DOWNLOAD + \"?id=\" + id\r\n            },\r\n            /**\r\n             * 删除图片\r\n             */\r\n            deletePicture(e, item) {\r\n                e.stopPropagation()\r\n                this.$confirm('图片删除后无法恢复, 是否继续?', '提示', {\r\n                    confirmButtonText: '确定',\r\n                    cancelButtonText: '取消',\r\n                    type: 'warning'\r\n                }).then(() => {\r\n                    this.ajax({\r\n                        url: API.ATTACHMENT.DELETE_PROPRIETARY + '?id=' + item.id,\r\n                        method: CONST.AJAX.GET,\r\n                    }).then(response => {\r\n                        if (this.currentId === item.id) {\r\n                            this.currentId = null\r\n                        }\r\n                        this.loadProprietaryList()\r\n                        this.$message(\"删除成功\");\r\n                    })\r\n                }).catch(() => {\r\n                })\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PictureStore.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PictureStore.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PictureStore.vue?vue&type=template&id=5e3a5d79&scoped=true&\"\nimport script from \"./PictureStore.vue?vue&type=script&lang=js&\"\nexport * from \"./PictureStore.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5e3a5d79\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}