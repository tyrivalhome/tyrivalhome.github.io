(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c8c55b2a"],{"02f4":function(t,e,n){var i=n("4588"),a=n("be13");t.exports=function(t){return function(e,n){var o,c,r=String(a(e)),s=i(n),l=r.length;return s<0||s>=l?t?"":void 0:(o=r.charCodeAt(s),o<55296||o>56319||s+1===l||(c=r.charCodeAt(s+1))<56320||c>57343?t?r.charAt(s):o:t?r.slice(s,s+2):c-56320+(o-55296<<10)+65536)}}},"0390":function(t,e,n){"use strict";var i=n("02f4")(!0);t.exports=function(t,e,n){return e+(n?i(t,e).length:1)}},"0b64":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"screen-design",attrs:{"element-loading-background":"rgba(0, 0, 0, 0.7)"}},[n("Menu",{attrs:{config:t.config,state:t.state}}),n("Paint",{attrs:{config:t.config,state:t.state}}),n("Layer",{attrs:{config:t.config,state:t.state}}),n("Config",{attrs:{config:t.config,state:t.state}}),n("ContextMenu",{attrs:{config:t.config,state:t.state}}),n("Publisher",{attrs:{config:t.config,state:t.state.publisher}}),t.state.addDataSourceModal.visible?n("DataSourceEdit",{attrs:{config:t.state.addDataSourceModal}}):t._e(),n("DynamicComponentList",{attrs:{config:t.config,state:t.state.dynamicComponent}}),n("DynamicComponentEdit",{attrs:{config:t.config,state:t.state.dynamicComponent}}),n("Loader",{attrs:{config:t.config,state:t.state.loader}}),n("PictureStore",{attrs:{config:t.config,state:t.state.pictureStore}}),n("div",{staticClass:"action"},[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"自定义组件",placement:"right"}},[n("el-button",{attrs:{type:"text"},on:{click:t.showDynamicComponentModal}},[n("i",{staticClass:"icon iconfont icon-star"})])],1),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"模板",placement:"right"}},[n("el-button",{attrs:{type:"text"},on:{click:t.template}},[n("i",{staticClass:"icon iconfont icon-layer"})])],1),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"发布",placement:"right"}},[n("el-button",{attrs:{type:"text"},on:{click:t.publish}},[n("i",{staticClass:"icon iconfont icon-plane"})])],1),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"保存",placement:"right"}},[n("el-button",{attrs:{type:"text"},on:{click:t.save}},[n("i",{staticClass:"icon iconfont icon-save"})])],1),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"预览",placement:"right"}},[n("el-button",{attrs:{type:"text"},on:{click:t.preview}},[n("i",{staticClass:"icon iconfont icon-view"})])],1),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"导入",placement:"right"}},[n("el-button",{attrs:{type:"text"},on:{click:t.loader}},[n("i",{staticClass:"icon iconfont icon-upload"})])],1),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"导出",placement:"right"}},[n("el-button",{attrs:{type:"text"},on:{click:t.exportConfig}},[n("i",{staticClass:"icon iconfont icon-download"})])],1),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"帮助",placement:"right"}},[n("el-button",{attrs:{type:"text"},on:{click:t.help}},[n("i",{staticClass:"icon iconfont icon-help"})])],1),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"退出",placement:"right"}},[n("el-button",{attrs:{type:"text"},on:{click:t.exit}},[n("i",{staticClass:"icon iconfont icon-exit"})])],1)],1),t.state.templateList.visible?n("TemplateList",{attrs:{templateList:t.state.templateList,config:t.config}}):t._e()],1)},a=[],o=(n("a481"),n("b864"),n("a3be")),c=n("7638"),r=n("2ef0"),s=n.n(r),l=function(){return n.e("chunk-14114396").then(n.bind(null,"fa5f"))},u=function(){return n.e("chunk-ad6a2ffc").then(n.bind(null,"31ba"))},f=function(){return Promise.all([n.e("chunk-4094bf41"),n.e("chunk-6b084e23"),n.e("chunk-b199dafe")]).then(n.bind(null,"93e8"))},d=function(){return Promise.all([n.e("chunk-4094bf41"),n.e("chunk-6b084e23"),n.e("chunk-b199dafe")]).then(n.bind(null,"5443"))},p=function(){return n.e("chunk-4094bf41").then(n.bind(null,"c144"))},h=function(){return n.e("chunk-1da9be0a").then(n.bind(null,"5257"))},g=function(){return n.e("chunk-bbaf3db0").then(n.bind(null,"4407"))},m=function(){return n.e("chunk-2d0c4bd4").then(n.bind(null,"3bb1"))},b=function(){return n.e("chunk-2d0f047e").then(n.bind(null,"9c64"))},v=function(){return n.e("chunk-78322721").then(n.bind(null,"f051"))},x=function(){return n.e("chunk-daa249ce").then(n.bind(null,"32a0"))},y=function(){return n.e("chunk-3461acd6").then(n.bind(null,"a5b3"))},C={name:"Design",data:function(){return{loading:!0,state:null,config:null}},created:function(){this.initScreen(),this.initActionSequence(),window.addEventListener("click",this.cancelSelectComponent)},mounted:function(){this.loadDynamicComponent()},methods:{initScreen:function(){var t=this;this.state={select:{},index:null,menu:{dragMode:!1,component:null},publisher:{visible:!1},pictureStore:{visible:!1,item:null,prop:null},dynamicComponent:{visible:!1,list:[],editMode:{visible:!1,item:null}},addDataSourceModal:{dataSource:null,visible:!1},contextMenu:{show:!1,refId:null,ids:null,style:{top:0,left:0}},loader:{visible:!1},drag:{id:null,isDragging:!1,start:null,end:null},grid:{id:"grid-"+(new Date).getTime(),configMode:!1,row:null,dragMode:{mouse:{x:null,y:null},column:null}},colorPicker:{enable:!1,list:[]},action:{sequence:[],index:null},templateList:{visible:!1,dataSource:{},isCustomTemplate:!0,isNew:!0}},this.config={id:null,name:"未命名",cover:null,state:0,base:{enableGrid:!1,size:{width:1800,height:1200},backgroundColor:"rgba(0,0,0,0)",backgroundImage:null,scaleMode:"0",grid:{style:{height:100},columns:[{id:"col-"+(new Date).getTime()+"1",style:{xs:8,sm:8,md:8,lg:8,xl:8},rows:[],components:{}},{id:"col-"+(new Date).getTime()+"2",style:{xs:8,sm:8,md:8,lg:8,xl:8},rows:[],components:{}},{id:"col-"+(new Date).getTime()+"3",style:{xs:8,sm:8,md:8,lg:8,xl:8},rows:[],components:{}}]},fullScreen:{id:null,component:null}},sequence:[],components:{}};var e=this.$route.query.id;e?this.ajax({url:o["a"].SCREEN.GET_BY_ID,params:{id:e}}).then((function(e){var n=e.data;n||t.$message.error("错误：未找到可视化。"),"string"==typeof n.base&&(n.base=JSON.parse(n.base)),"string"==typeof n.sequence&&(n.sequence=JSON.parse(n.sequence)),"string"==typeof n.components&&(n.components=JSON.parse(n.components)),"ON"===n.state?n.state=1:n.state=0,t.config=n})).finally((function(){t.loading=!1})):this.loading=!1},initActionSequence:function(){this.state.action.sequence.push(s.a.cloneDeep(this.config)),this.state.action.index=0},cancelSelectComponent:function(t){this.$set(this.state,"select",{}),this.state.grid.configMode=!1,this.state.grid.row=null},save:function(){var t=this,e=this.formatConfigParam(this.config);e.type=this.$route.query.saveType,this.ajax({url:o["a"].SCREEN.SAVE,method:c["a"].AJAX.POST,data:e}).then((function(e){e.success&&(t.config.id||(t.config.id=e.data.id),t.$message(c["a"].MESSAGE.SAVE_SUCCESS),t.$router.replace({query:{id:t.config.id}}))}))},publish:function(){this.state.publisher.visible=!0},formatConfigParam:function(t){var e=s.a.cloneDeep(t);for(var n in e){var i=e[n];s.a.isObject(i)&&(e[n]=JSON.stringify(i))}return e},preview:function(){var t=this,e=this.formatConfigParam(this.config);this.ajax({url:o["a"].SCREEN.PREVIEW,method:c["a"].AJAX.POST,data:e}).then((function(e){var n=t.$router.resolve({path:"./presentation",query:{id:e.data.id}});window.open(n.href,"_blank")}))},loader:function(){this.state.loader.visible=!0},exportConfig:function(){var t=s.a.cloneDeep(this.config);t.id=null;var e=document.createElement("a"),n=new Blob([JSON.stringify(t,null,4)]);e.download="config-"+(new Date).getTime()+".txt",e.href=URL.createObjectURL(n),e.click(),URL.revokeObjectURL(n)},help:function(){window.open("http://www.tyrival.com/books/vision-guide/","_blank")},exit:function(){var t=this;this.$confirm("退出编辑界面会丢失所有未保存的操作, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$router.push("./overview")})).catch((function(){}))},template:function(){var t=this.formatConfigParam(this.config);this.state.templateList.visible=!0,this.state.templateList.dataSource=t},loadDynamicComponent:function(){var t=this;this.ajax({url:o["a"].DYNAMIC_COMPONENT.LIST,method:c["a"].AJAX.GET}).then((function(e){e.data.success&&(t.state.dynamicComponent.list=e.data.data)}))},showDynamicComponentModal:function(){this.state.dynamicComponent.visible=!0}},components:{Menu:l,Layer:u,Config:f,Paint:d,Publisher:h,ContextMenu:p,DataSourceEdit:x,TemplateList:y,Loader:g,PictureStore:m,DynamicComponentList:b,DynamicComponentEdit:v}},k=C,S=n("2877"),w=Object(S["a"])(k,i,a,!1,null,"40397f00",null);e["default"]=w.exports},"0bfb":function(t,e,n){"use strict";var i=n("cb7c");t.exports=function(){var t=i(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},"214f":function(t,e,n){"use strict";n("b0c5");var i=n("2aba"),a=n("32e9"),o=n("79e5"),c=n("be13"),r=n("2b4c"),s=n("520a"),l=r("species"),u=!o((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),f=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();t.exports=function(t,e,n){var d=r(t),p=!o((function(){var e={};return e[d]=function(){return 7},7!=""[t](e)})),h=p?!o((function(){var e=!1,n=/a/;return n.exec=function(){return e=!0,null},"split"===t&&(n.constructor={},n.constructor[l]=function(){return n}),n[d](""),!e})):void 0;if(!p||!h||"replace"===t&&!u||"split"===t&&!f){var g=/./[d],m=n(c,d,""[t],(function(t,e,n,i,a){return e.exec===s?p&&!a?{done:!0,value:g.call(e,n,i)}:{done:!0,value:t.call(n,e,i)}:{done:!1}})),b=m[0],v=m[1];i(String.prototype,t,b),a(RegExp.prototype,d,2==e?function(t,e){return v.call(t,this,e)}:function(t){return v.call(t,this)})}}},"520a":function(t,e,n){"use strict";var i=n("0bfb"),a=RegExp.prototype.exec,o=String.prototype.replace,c=a,r="lastIndex",s=function(){var t=/a/,e=/b*/g;return a.call(t,"a"),a.call(e,"a"),0!==t[r]||0!==e[r]}(),l=void 0!==/()??/.exec("")[1],u=s||l;u&&(c=function(t){var e,n,c,u,f=this;return l&&(n=new RegExp("^"+f.source+"$(?!\\s)",i.call(f))),s&&(e=f[r]),c=a.call(f,t),s&&c&&(f[r]=f.global?c.index+c[0].length:e),l&&c&&c.length>1&&o.call(c[0],n,(function(){for(u=1;u<arguments.length-2;u++)void 0===arguments[u]&&(c[u]=void 0)})),c}),t.exports=c},"5f1b":function(t,e,n){"use strict";var i=n("23c6"),a=RegExp.prototype.exec;t.exports=function(t,e){var n=t.exec;if("function"===typeof n){var o=n.call(t,e);if("object"!==typeof o)throw new TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==i(t))throw new TypeError("RegExp#exec called on incompatible receiver");return a.call(t,e)}},a481:function(t,e,n){"use strict";var i=n("cb7c"),a=n("4bf8"),o=n("9def"),c=n("4588"),r=n("0390"),s=n("5f1b"),l=Math.max,u=Math.min,f=Math.floor,d=/\$([$&`']|\d\d?|<[^>]*>)/g,p=/\$([$&`']|\d\d?)/g,h=function(t){return void 0===t?t:String(t)};n("214f")("replace",2,(function(t,e,n,g){return[function(i,a){var o=t(this),c=void 0==i?void 0:i[e];return void 0!==c?c.call(i,o,a):n.call(String(o),i,a)},function(t,e){var a=g(n,t,this,e);if(a.done)return a.value;var f=i(t),d=String(this),p="function"===typeof e;p||(e=String(e));var b=f.global;if(b){var v=f.unicode;f.lastIndex=0}var x=[];while(1){var y=s(f,d);if(null===y)break;if(x.push(y),!b)break;var C=String(y[0]);""===C&&(f.lastIndex=r(d,o(f.lastIndex),v))}for(var k="",S=0,w=0;w<x.length;w++){y=x[w];for(var E=String(y[0]),D=l(u(c(y.index),d.length),0),M=[],L=1;L<y.length;L++)M.push(h(y[L]));var T=y.groups;if(p){var A=[E].concat(M,D,d);void 0!==T&&A.push(T);var $=String(e.apply(void 0,A))}else $=m(E,d,D,M,T,e);D>=S&&(k+=d.slice(S,D)+$,S=D+E.length)}return k+d.slice(S)}];function m(t,e,i,o,c,r){var s=i+t.length,l=o.length,u=p;return void 0!==c&&(c=a(c),u=d),n.call(r,u,(function(n,a){var r;switch(a.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,i);case"'":return e.slice(s);case"<":r=c[a.slice(1,-1)];break;default:var u=+a;if(0===u)return n;if(u>l){var d=f(u/10);return 0===d?n:d<=l?void 0===o[d-1]?a.charAt(1):o[d-1]+a.charAt(1):n}r=o[u-1]}return void 0===r?"":r}))}}))},b0c5:function(t,e,n){"use strict";var i=n("520a");n("5ca1")({target:"RegExp",proto:!0,forced:i!==/./.exec},{exec:i})},b864:function(t,e,n){}}]);
//# sourceMappingURL=chunk-c8c55b2a.26fe8ab3.js.map