{"version":3,"sources":["webpack:///./node_modules/core-js/modules/_fails-is-regexp.js","webpack:///./node_modules/core-js/modules/es6.function.name.js","webpack:///./node_modules/core-js/modules/_is-regexp.js","webpack:///./src/utils/IdGenerator.js","webpack:///./node_modules/core-js/modules/_string-context.js","webpack:///./node_modules/core-js/modules/es6.string.starts-with.js","webpack:///./src/components/screen/Menu.vue?9776","webpack:///src/components/screen/Menu.vue","webpack:///./src/components/screen/Menu.vue?21de","webpack:///./src/components/screen/Menu.vue"],"names":["MATCH","module","exports","KEY","re","e","f","dP","FProto","Function","prototype","nameRE","NAME","configurable","get","this","match","isObject","cof","it","isRegExp","undefined","IdGenerator","random","prefix","Date","getTime","Math","ceil","randomCmpId","randomFullScreenId","validateCmpId","id","startsWith","num","replace","timestamp","floor","defined","that","searchString","TypeError","String","$export","toLength","context","STARTS_WITH","$startsWith","P","F","index","min","arguments","length","search","call","slice","render","_vm","_h","$createElement","_c","_self","staticClass","_l","node","i","key","on","$event","show","attrs","class","icon","directives","name","rawName","value","expression","category","j","slot","item","k","addComponent","getComponentImage","dragComponent","endDrag","_v","_s","text","staticRenderFns","component"],"mappings":"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","file":"js/chunk-14114396.6fec1a74.js","sourcesContent":["var MATCH = require('./_wks')('match');\nmodule.exports = function (KEY) {\n  var re = /./;\n  try {\n    '/./'[KEY](re);\n  } catch (e) {\n    try {\n      re[MATCH] = false;\n      return !'/./'[KEY](re);\n    } catch (f) { /* empty */ }\n  } return true;\n};\n","var dP = require('./_object-dp').f;\nvar FProto = Function.prototype;\nvar nameRE = /^\\s*function ([^ (]*)/;\nvar NAME = 'name';\n\n// 19.2.4.2 name\nNAME in FProto || require('./_descriptors') && dP(FProto, NAME, {\n  configurable: true,\n  get: function () {\n    try {\n      return ('' + this).match(nameRE)[1];\n    } catch (e) {\n      return '';\n    }\n  }\n});\n","// 7.2.8 IsRegExp(argument)\nvar isObject = require('./_is-object');\nvar cof = require('./_cof');\nvar MATCH = require('./_wks')('match');\nmodule.exports = function (it) {\n  var isRegExp;\n  return isObject(it) && ((isRegExp = it[MATCH]) !== undefined ? !!isRegExp : cof(it) == 'RegExp');\n};\n","const IdGenerator = {\n    random: function (prefix) {\n        return prefix + new Date().getTime() + Math.ceil(Math.random() * 10000)\n    },\n    randomCmpId: function () {\n        return this.random(\"cmp-\")\n    },\n    randomFullScreenId: function () {\n        return this.random(\"full-screen-\")\n    },\n    validateCmpId: function (id) {\n        let prefix = \"cmp-\"\n        if (!id.startsWith(prefix)) {\n            return false\n        }\n        let num = id.replace(prefix, \"\") / 10000\n        let timestamp = Math.floor(num)\n        if (!new Date(timestamp) instanceof Date) {\n            return false\n        }\n        return true\n    }\n}\n\nexport default IdGenerator;","// helper for String#{startsWith, endsWith, includes}\nvar isRegExp = require('./_is-regexp');\nvar defined = require('./_defined');\n\nmodule.exports = function (that, searchString, NAME) {\n  if (isRegExp(searchString)) throw TypeError('String#' + NAME + \" doesn't accept regex!\");\n  return String(defined(that));\n};\n","// 21.1.3.18 String.prototype.startsWith(searchString [, position ])\n'use strict';\nvar $export = require('./_export');\nvar toLength = require('./_to-length');\nvar context = require('./_string-context');\nvar STARTS_WITH = 'startsWith';\nvar $startsWith = ''[STARTS_WITH];\n\n$export($export.P + $export.F * require('./_fails-is-regexp')(STARTS_WITH), 'String', {\n  startsWith: function startsWith(searchString /* , position = 0 */) {\n    var that = context(this, searchString, STARTS_WITH);\n    var index = toLength(Math.min(arguments.length > 1 ? arguments[1] : undefined, that.length));\n    var search = String(searchString);\n    return $startsWith\n      ? $startsWith.call(that, search, index)\n      : that.slice(index, index + search.length) === search;\n  }\n});\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"menu\"},[_vm._l((_vm.menu),function(node,i){return [_c('div',{key:i,staticClass:\"node\",on:{\"mouseover\":function($event){node.show = true},\"mouseleave\":function($event){node.show = false}}},[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"mini\",\"circle\":\"\"}},[_c('i',{staticClass:\"icon iconfont\",class:'icon-' + node.icon})]),_c('el-tabs',{directives:[{name:\"show\",rawName:\"v-show\",value:(node.show),expression:\"node.show\"}],attrs:{\"type\":\"border-card\",\"tab-position\":\"left\"}},[_vm._l((node.categories),function(category,j){return [_c('el-tab-pane',{key:j},[_c('span',{attrs:{\"slot\":\"label\"},slot:\"label\"},[_c('i',{staticClass:\"icon iconfont\",class:'icon-' + category.icon})]),_vm._l((category.items),function(item,k){return [_c('div',{key:k,staticClass:\"item-card\",on:{\"click\":function($event){return _vm.addComponent(i, j, k)}}},[_c('img',{attrs:{\"src\":_vm.getComponentImage(item)},on:{\"drag\":function($event){node.show = false},\"dragstart\":function($event){return _vm.dragComponent($event, i, j, k)},\"dragend\":function($event){return _vm.endDrag($event)}}}),_c('div',{staticClass:\"item-name\"},[_vm._v(_vm._s(item.text))])])]})],2)]})],2)],1)]})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"menu\">\r\n        <template v-for=\"(node, i) in menu\">\r\n            <div class=\"node\"\r\n                 :key=\"i\"\r\n                 @mouseover=\"node.show = true\"\r\n                 @mouseleave=\"node.show = false\">\r\n                <el-button type=\"primary\"\r\n                           size=\"mini\"\r\n                           circle>\r\n                    <i :class=\"'icon-' + node.icon\" class=\"icon iconfont\"></i>\r\n                </el-button>\r\n                <el-tabs v-show=\"node.show\"\r\n                         type=\"border-card\"\r\n                         tab-position=\"left\">\r\n                    <template v-for=\"(category, j) in node.categories\">\r\n                        <el-tab-pane :key=\"j\">\r\n                            <span slot=\"label\"><i :class=\"'icon-' + category.icon\" class=\"icon iconfont\"></i></span>\r\n                            <template v-for=\"(item, k) in category.items\">\r\n                                <div class=\"item-card\" :key=\"k\" @click=\"addComponent(i, j, k)\">\r\n                                    <img :src=\"getComponentImage(item)\"\r\n                                         @drag=\"node.show = false\"\r\n                                         @dragstart=\"dragComponent($event, i, j, k)\"\r\n                                         @dragend=\"endDrag($event)\">\r\n                                    <div class=\"item-name\">{{item.text}}</div>\r\n                                </div>\r\n                            </template>\r\n                        </el-tab-pane>\r\n                    </template>\r\n                </el-tabs>\r\n            </div>\r\n        </template>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import IdGenerator from \"../../utils/IdGenerator\";\r\n    import _ from \"lodash\";\r\n\r\n    export default {\r\n        name: \"Menu\",\r\n        props: [\"config\", \"state\"],\r\n        data() {\r\n            return {\r\n                showPanel: false,\r\n                menu: null\r\n            }\r\n        },\r\n        mounted() {\r\n            this.initComponentMenu()\r\n        },\r\n        methods: {\r\n            initComponentMenu() {\r\n                this.menu = _.clone(this.$store.state.screen.design.menu)\r\n                let components = this.state.dynamicComponent.list\r\n                if (components && components.length) {\r\n                    this.menu.push({\r\n                        icon: 'star',\r\n                        text: '自定义组件',\r\n                        show: false,\r\n                        categories: [{\r\n                            text: '自定义组件',\r\n                            icon: 'star',\r\n                            items: components\r\n                        }]\r\n                    });\r\n                }\r\n            },\r\n            /**\r\n             * 获取组件缩略图\r\n             */\r\n            getComponentImage(item) {\r\n                if (item.image) {\r\n                    return item.image\r\n                }\r\n                return './img/components/' + item.category + '/' + item.name + '.png';\r\n            },\r\n            /**\r\n             * 添加一个组件\r\n             * @param i\r\n             * @param j\r\n             * @param k\r\n             */\r\n            addComponent(i, j, k) {\r\n                let item = this.menu[i].categories[j].items[k]\r\n                if (!this.config.components) {\r\n                    this.config.components = {}\r\n                }\r\n                if (!this.config.sequence) {\r\n                    this.config.sequence = []\r\n                }\r\n                let cmp = this.generateComponent(item)\r\n                let id = cmp.config.id\r\n                this.config.sequence.unshift(id)\r\n                this.$set(this.config.components, id, cmp)\r\n            },\r\n            /**\r\n             * 拖放一个组件\r\n             * @param i\r\n             * @param j\r\n             * @param k\r\n             */\r\n            dragComponent(event, i, j, k) {\r\n                this.state.menu.dragMode = true;\r\n                let item = this.menu[i].categories[j].items[k]\r\n                this.state.menu.component = this.generateComponent(item)\r\n            },\r\n            /**\r\n             * 生成组件的配置文件\r\n             */\r\n            generateComponent(item) {\r\n                let id = IdGenerator.randomCmpId()\r\n                return {\r\n                    text: item.text,\r\n                    category: item.category,\r\n                    name: item.name,\r\n                    image: item.image,\r\n                    config: {\r\n                        remote: {\r\n                            config: item.config\r\n                        },\r\n                        // id\r\n                        id: id,\r\n                        // 栅格ID\r\n                        grid: {id: null},\r\n                        // 临时状态存储\r\n                        state: {\r\n                            // 是否已初始化过配置\r\n                            configInit: false\r\n                        },\r\n                        // 样式\r\n                        style: {},\r\n                        // 触发器\r\n                        trigger: null,\r\n                        // 功能配置\r\n                        option: null,\r\n                        // 与全局状态的绑定规则，当全局状态发生变更，会分发消息到此处，\r\n                        // 组件内可以通过监听该状态，来更新自身的状态\r\n                        store: {\r\n                            proxy: null,\r\n                            trigger: null\r\n                        },\r\n                        // 静态数据或者从远端获取的数据存储\r\n                        data: null,\r\n                        // 数据代理，获取数据的方式\r\n                        proxy: null,\r\n                        // 数据转换，proxy获取到的数据，经过transform转换规则的处理，存储到data属性中\r\n                        transform: null,\r\n                        // 将data数据根据展示需要，转换到option中\r\n                        handler: null,\r\n                        // 事件，以及事件中的参数与全局状态的绑定配置\r\n                        event: null\r\n                    }\r\n                }\r\n            },\r\n            /**\r\n             * 停止拖拽\r\n             */\r\n            endDrag(event) {\r\n                this.state.menu.dragMode = false;\r\n                this.state.menu.component = null;\r\n            },\r\n        },\r\n        watch: {\r\n            /**\r\n             * 监听组件清单，变化后重新载入组件\r\n             */\r\n            \"state.dynamicComponent.list\": {\r\n                immediate: true,\r\n                handler: function () {\r\n                    this.initComponentMenu()\r\n                }\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Menu.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Menu.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Menu.vue?vue&type=template&id=e24b3fbe&scoped=true&\"\nimport script from \"./Menu.vue?vue&type=script&lang=js&\"\nexport * from \"./Menu.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e24b3fbe\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}