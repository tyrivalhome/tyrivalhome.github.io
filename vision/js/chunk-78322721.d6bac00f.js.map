{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es6.function.name.js","webpack:///./src/components/screen/DynamicComponentEdit.vue?621c","webpack:///src/components/screen/DynamicComponentEdit.vue","webpack:///./src/components/screen/DynamicComponentEdit.vue?363f","webpack:///./src/components/screen/DynamicComponentEdit.vue"],"names":["dP","f","FProto","Function","prototype","nameRE","NAME","configurable","get","this","match","e","render","_vm","_h","$createElement","_c","_self","attrs","state","editMode","visible","on","$event","$set","item","rules","model","value","callback","$$v","expression","directives","name","rawName","changeCategory","_l","i","key","text","staticClass","getToken","getUploadUrl","beforeUpload","onSuccessCover","onError","image","_e","_v","removeCoverImage","slot","save","staticRenderFns","component"],"mappings":"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","file":"js/chunk-78322721.d6bac00f.js","sourcesContent":["var dP = require('./_object-dp').f;\nvar FProto = Function.prototype;\nvar nameRE = /^\\s*function ([^ (]*)/;\nvar NAME = 'name';\n\n// 19.2.4.2 name\nNAME in FProto || require('./_descriptors') && dP(FProto, NAME, {\n  configurable: true,\n  get: function () {\n    try {\n      return ('' + this).match(nameRE)[1];\n    } catch (e) {\n      return '';\n    }\n  }\n});\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-dialog',{attrs:{\"width\":\"60%\",\"top\":\"20px\",\"title\":\"自定义组件\",\"visible\":_vm.state.editMode.visible,\"close-on-click-modal\":false},on:{\"update:visible\":function($event){return _vm.$set(_vm.state.editMode, \"visible\", $event)}}},[(_vm.state.editMode.item)?_c('el-form',{attrs:{\"model\":_vm.state.editMode.item,\"rules\":_vm.rules,\"size\":\"small\",\"label-width\":\"80px\"}},[_c('el-row',[_c('el-col',{attrs:{\"span\":24}},[_c('el-form-item',{attrs:{\"label\":\"名称\",\"prop\":\"text\"}},[_c('el-input',{model:{value:(_vm.state.editMode.item.text),callback:function ($$v) {_vm.$set(_vm.state.editMode.item, \"text\", $$v)},expression:\"state.editMode.item.text\"}})],1)],1),_c('el-col',{directives:[{name:\"show\",rawName:\"v-show\",value:(false),expression:\"false\"}],attrs:{\"span\":12}},[_c('el-form-item',{attrs:{\"label\":\"类型\",\"prop\":\"category\"}},[_c('el-select',{on:{\"change\":function($event){return _vm.changeCategory($event)}},model:{value:(_vm.state.editMode.item.category),callback:function ($$v) {_vm.$set(_vm.state.editMode.item, \"category\", $$v)},expression:\"state.editMode.item.category\"}},[_vm._l((_vm.dynamicComponents),function(item,i){return [_c('el-option',{key:i,attrs:{\"label\":item.text,\"value\":item.value}})]})],2)],1)],1)],1),_c('el-row',[_c('el-form-item',{attrs:{\"label\":\"图片\",\"prop\":\"image\"}},[_c('el-input',{attrs:{\"placeholder\":\"请输入图片网址\",\"size\":\"mini\",\"clearable\":\"\"},model:{value:(_vm.state.editMode.item.image),callback:function ($$v) {_vm.$set(_vm.state.editMode.item, \"image\", $$v)},expression:\"state.editMode.item.image\"}}),_c('el-upload',{staticClass:\"img-upload\",attrs:{\"drag\":\"\",\"headers\":_vm.getToken(),\"action\":_vm.getUploadUrl(),\"before-upload\":_vm.beforeUpload,\"on-success\":_vm.onSuccessCover,\"on-Error\":_vm.onError,\"show-file-list\":false}},[(_vm.state.editMode.item.image)?_c('img',{staticClass:\"img-preview\",attrs:{\"src\":_vm.state.editMode.item.image}}):_vm._e(),_c('i',{staticClass:\"el-icon-upload\"}),_c('div',{staticClass:\"el-upload__text\"},[_vm._v(\"将文件拖到此处，或\"),_c('em',[_vm._v(\"点击上传\")])])]),(_vm.state.editMode.item.image)?_c('div',{staticClass:\"img-cover\"},[_c('i',{staticClass:\"icon iconfont icon-delete\",on:{\"click\":function($event){return _vm.removeCoverImage()}}})]):_vm._e()],1)],1),_c('el-form-item',{attrs:{\"label\":\"配置\",\"prop\":\"config\"}},[_c('el-input',{attrs:{\"type\":\"textarea\",\"rows\":16,\"size\":\"mini\",\"resize\":\"none\"},model:{value:(_vm.state.editMode.item.config),callback:function ($$v) {_vm.$set(_vm.state.editMode.item, \"config\", $$v)},expression:\"state.editMode.item.config\"}})],1)],1):_vm._e(),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"primary\"},on:{\"click\":_vm.save}},[_vm._v(\"保 存\")]),_c('el-button',{attrs:{\"size\":\"mini\"},on:{\"click\":function($event){_vm.state.editMode.visible = false}}},[_vm._v(\"取 消\")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <el-dialog width=\"60%\"\n               top=\"20px\"\n               title=\"自定义组件\"\n               :visible.sync=\"state.editMode.visible\"\n               :close-on-click-modal=\"false\">\n        <el-form v-if=\"state.editMode.item\" :model=\"state.editMode.item\" :rules=\"rules\" size=\"small\" label-width=\"80px\">\n            <el-row>\n                <el-col :span=\"24\">\n                    <el-form-item label=\"名称\" prop=\"text\">\n                        <el-input v-model=\"state.editMode.item.text\"></el-input>\n                    </el-form-item>\n                </el-col>\n                <el-col :span=\"12\" v-show=\"false\">\n                    <el-form-item label=\"类型\" prop=\"category\">\n                        <el-select v-model=\"state.editMode.item.category\"\n                                   @change=\"changeCategory($event)\">\n                            <template v-for=\"(item, i) in dynamicComponents\">\n                                <el-option :key=\"i\" :label=\"item.text\" :value=\"item.value\"></el-option>\n                            </template>\n                        </el-select>\n                    </el-form-item>\n                </el-col>\n            </el-row>\n            <el-row>\n                <el-form-item label=\"图片\" prop=\"image\">\n                    <el-input v-model=\"state.editMode.item.image\"\n                              placeholder=\"请输入图片网址\"\n                              size=\"mini\" clearable></el-input>\n                    <el-upload drag\n                               class=\"img-upload\"\n                               :headers=\"getToken()\"\n                               :action=\"getUploadUrl()\"\n                               :before-upload=\"beforeUpload\"\n                               :on-success=\"onSuccessCover\"\n                               :on-Error=\"onError\"\n                               :show-file-list=\"false\">\n                        <img v-if=\"state.editMode.item.image\"\n                             :src=\"state.editMode.item.image\"\n                             class=\"img-preview\">\n                        <i class=\"el-icon-upload\"></i>\n                        <div class=\"el-upload__text\">将文件拖到此处，或<em>点击上传</em></div>\n                    </el-upload>\n                    <div v-if=\"state.editMode.item.image\"\n                         class=\"img-cover\">\n                        <i class=\"icon iconfont icon-delete\" @click=\"removeCoverImage()\"></i>\n                    </div>\n                </el-form-item>\n            </el-row>\n            <el-form-item label=\"配置\" prop=\"config\">\n                <el-input v-model=\"state.editMode.item.config\"\n                          type=\"textarea\"\n                          :rows=\"16\"\n                          size=\"mini\"\n                          resize=\"none\">\n                </el-input>\n            </el-form-item>\n        </el-form>\n        <div slot=\"footer\" class=\"dialog-footer\">\n            <el-button size=\"mini\" type=\"primary\" @click=\"save\">保 存</el-button>\n            <el-button size=\"mini\" @click=\"state.editMode.visible = false\">取 消</el-button>\n        </div>\n    </el-dialog>\n</template>\n\n<script>\n    import CONST from '../../config/const'\n    import API from \"../../config/api\";\n\n    export default {\n        name: \"DynamicComponentEdit\",\n        props: ['config', 'state'],\n        data() {\n            return {\n                dynamicComponents: CONST.DYNAMIC_COMPONENTS,\n                rules: {\n                    text: [\n                        {required: true, message: '名称不可为空', trigger: 'blur'}\n                    ],\n                    category: [\n                        {required: true, message: '类型不可为空', trigger: 'blur'}\n                    ],\n                    name: [\n                        {required: true, message: '不可为空', trigger: 'blur'}\n                    ],\n                    image: [\n                        {required: true, message: '配置不可为空', trigger: 'blur'}\n                    ],\n                    config: [\n                        {required: true, message: '配置不可为空', trigger: 'blur'}\n                    ],\n                },\n            }\n        },\n        methods: {\n            /**\n             * 加载配置\n             */\n            save() {\n                this.ajax({\n                    url: API.DYNAMIC_COMPONENT.SAVE,\n                    method: CONST.AJAX.POST,\n                    data: this.state.editMode.item,\n                }).then(response => {\n                    if (response.success) {\n                        this.$parent.loadDynamicComponent();\n                        this.$message(CONST.MESSAGE.SAVE_SUCCESS)\n                        this.state.editMode.visible = false\n                    }\n                })\n            },\n            /**\n             * 修改组件类型\n             */\n            changeCategory(val) {\n                for (let i = 0; i < this.dynamicComponents.length; i++) {\n                    let opt = this.dynamicComponents[i]\n                    if (opt.value !== val) {\n                        continue\n                    }\n                    this.state.editMode.item.name = opt.name\n                    return\n                }\n            },\n            /**\n             * 上传之前\n             */\n            beforeUpload(file) {\n                let name = file.name\n                let ext = name.substring(name.lastIndexOf(\".\") + 1).toLowerCase()\n                if (ext !== \"jpg\" && ext !== \"png\" && ext !== 'bmp' && ext !== 'jpeg' && ext !== 'gif') {\n                    this.$message({\n                        message: \"只支持jpg、png、bmp文件\",\n                        type: \"error\"\n                    })\n                    return false\n                }\n            },\n            /**\n             * 获取上传地址\n             */\n            getUploadUrl() {\n                return API.ATTACHMENT.UPLOAD\n            },\n            /**\n             * 获取token作文参数上传\n             */\n            getToken() {\n                return {token: this.$store.state.token}\n            },\n            /**\n             * 上传封面成功\n             */\n            onSuccessCover(res) {\n                this.state.editMode.item.image = API.ATTACHMENT.DOWNLOAD + \"?id=\" + res.data.id\n            },\n            /**\n             * 上传失败\n             */\n            onError(err) {\n                this.$message({\n                    message: err.data.message,\n                    type: \"error\"\n                })\n            },\n            /**\n             * 移除封面图\n             */\n            removeCoverImage() {\n                this.state.editMode.item.image = null\n            },\n        }\n    }\n</script>\n\n<style scoped>\n\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DynamicComponentEdit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DynamicComponentEdit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DynamicComponentEdit.vue?vue&type=template&id=e24709bc&scoped=true&\"\nimport script from \"./DynamicComponentEdit.vue?vue&type=script&lang=js&\"\nexport * from \"./DynamicComponentEdit.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e24709bc\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}